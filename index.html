<!doctype html>
<!-- The Time Machine GitHub pages theme was designed and developed by Jon Rohan, on Feb 7, 2012. -->
<!-- Follow him for fun. https://twitter.com/jonrohan. Tail his code on https://github.com/jonrohan -->
<html>
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <meta name="dcterms:modified" content="2022-04-19"/>

  <link rel="stylesheet" href="stylesheets/stylesheet.css" media="screen"/>
  <link rel="stylesheet" href="stylesheets/pygment_trac.css"/>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="javascripts/script.js"></script>

  <title>Nordic EPUB3/DTBook Migrator</title>
  <meta name="description" content="Tools for validating and converting Nordic Guidelines-conforming EPUB 3, HTML and DTBook files."/>

  <meta name="viewport" content="width=device-width,initial-scale=1"/>

</head>

<body>

  <div class="wrapper">
    <header>
      <h1 class="title"><a href="index.html">Nordic EPUB3/DTBook Migrator</a></h1>
    </header>
    <div id="container">
      <p class="tagline">A tool for validating and converting <a href="https://format.mtm.se/nordic_epub/">Nordic Guidelines</a>-conforming EPUB 3, HTML and DTBook files.</p>
      <div id="main" role="main">
        <div class="download-bar">
        <div class="inner">
          <a href="https://github.com/nlbdev/nordic-epub3-dtbook-migrator" class="code">View Nordic EPUB3/DTBook Migrator on GitHub</a>
        </div>
        <span class="blc"></span><span class="trc"></span>
        </div>
        <article class="markdown-body">
	  <h1><a name="nordic-epub3dtbook-migrator" class="anchor" href="#nordic-epub3dtbook-migrator"><span class="octicon octicon-link"></span></a>About the tool</h1>
	  <p>The Nordic EPUB3/DTBook Migrator is a tool for validating and converting <a href="https://format.mtm.se/nordic_epub/">Nordic Guidelines</a>-conforming EPUB 3, HTML and DTBook file sets. It is implemented as a <a href="https://daisy.github.io/pipeline">DAISY Pipeline 2</a> script and is being used for the production of accessible literature by the (mostly) Nordic organizations <a href="https://www.celia.fi/">Celia</a>, <a href="https://www.dedicon.nl/">Dedicon</a>, <a href="https://hbs.is/">HBS</a>, <a href="https://mtm.se">MTM</a>, <a href="https://www.nlb.no/">NLB</a>, <a href="https://nota.dk/">Nota</a>, <a href="https://www.sbs.ch/">SBS</a>, <a href="https://www.spsm.se/">SPSM</a>, and <a href="http://statped.no/">Statped</a>.</p>
	  <p>The tool supports EPUB 3-only workflows, where primarily validation is needed, or EPUB 3—DTBook workflows, where the primary production is carried out in EPUB 3 but including a conversion to DTBook, allowing the organization to use the output in legacy DTBook-based tools, e.g. TTS or Braille production tools. The tool's conversion capabilities work in both directions, so it can also be used to upgrade legacy DTBook file sets to EPUB 3.</p>
	  <p>The Nordic EPUB3/DTBook Migrator is closely related to the development of the <a href="https://format.mtm.se/nordic_epub/">Nordic Guidelines</a>, a joint application of EPUB 3 and DTBook formats for the production of accessible content at the Nordic organizations. Currently, only validation is supported for files conforming to the <a href="https://format.mtm.se/nordic_epub/2020-1/">2020-1</a> version of the guidelines. For <a href="https://format.mtm.se/nordic_epub/2015-1/">2015-1</a>-conforming files, conversion between e.g. EPUB 3 and DTBook is also supported.</p>
	  <p>This project provides the following Pipeline 2 scripts:</p>
	  <ul>
	    <li>EPUB3 Validator</li>
	    <li>EPUB3 to DTBook (2015-1 guidelines only)</li>
	    <li>EPUB3 to HTML (2015-1 guidelines only)</li>
	    <li>EPUB3 ASCIIMath to MathML (2015-1 guidelines only)</li>
	    <li>HTML to EPUB3 (2015-1 guidelines only)</li>
	    <li>HTML to DTBook (2015-1 guidelines only)</li>
	    <li>HTML Validator (2015-1 guidelines only)</li>
	    <li>DTBook to EPUB3 (2015-1 guidelines only)</li>
	    <li>DTBook to HTML (2015-1 guidelines only)</li>
	    <li>DTBook Validator (2015-1 guidelines only)</li>
	  </ul>
	  <h2>Additional notes</h2>
	  <ul>
	    <li>Scripts for converting to and from the intermediary single-HTML representation of the publications are also provided. These are useful either for debugging, or if a single-document HTML representation is needed as input to or output from an HTML-based production system.</li>
	    <li>In the 2015-1 Nordic Guidelines, math is marked up using ASCIIMath. An experimental script for converting this ASCIIMath to MathML is provided.</li>
	    <li>The grammar used in the EPUB 3, HTML and DTBook files—the Nordic Guidelines—is a strict subset of EPUB 3, HTML and DTBook. Most DTBooks will work with these scripts. There are few limitations to the input DTBook grammar. There are more limitations to the HTML/EPUB 3 grammar however, because there must be a way to convert it to DTBook. Most notably, multimedia such as audio and video are currently not allowed in these EPUB 3s.</li>
	    <li>The Nordic EPUB3 Validator script can validate according to both 2015-1 and 2020-1 rulesets. Which ruleset will be applied is determined by the value of the <code>&lt;meta property="nordic:guidelines"&gt;</code> element in <code>package.opf</code>.</li>
	  </ul>
          <h1><a name="installation-2" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Latest version: 2.0.0-SNAPSHOT</h1>
          <p>The 2.x versions of nordic-epub3-dtbook-migrator can only be run through Docker. But it has both a command line interface, and an API.</p>
          <h2>Command line interface</h2>
          <p>Example of running the command line interface:</p>
          <pre><kbd>docker run --rm -it -v "$(pwd)":"$(pwd)" -w "$(pwd)" nlbdev/nordic-epub3-dtbook-migrato java -jar /var/www/bin/NordicValidator.jar</kbd></pre>
          <p>Example of validating an EPUB from the command line::</p>
          <pre><kbd>docker run --rm -it -v "$(pwd)":"$(pwd)" -w "$(pwd)" nlbdev/nordic-epub3-dtbook-migrato java -jar /var/www/bin/NordicValidator.jar X60352A.epub</kbd></pre>
          <h2>REST API</h2>
          <p>Example of starting the Docker container as a service:</p>
          <pre><kbd>docker run --publish 8080:80 nlbdev/nordic-epub3-dtbook-migrator</kbd></pre>
	  <p>Example of validating an EPUB using the API and curl:</p>
	  <pre><kbd>curl -s -F config='{"noEPUBCheck":false,"noACE":false,"schema":"2020-1"}' -F file=@X60352A.epub http://localhost:8080/v1/Validation</kbd></pre>
	  <p>When it comes to documentation, the SwaggerAPI / OpenAPI documentation can be viewed either by downloading an editor like <a href="https://www.postman.com/downloads/">Postman</a>, or going to <a href="https://editor.swagger.io/">https://editor.swagger.io/</a>. The API definition is available on the following URL, and you can either download the file and upload it to the editor, or import the URL directly:</p>
	  <pre><kbd>https://raw.githubusercontent.com/nlbdev/nordic-epub3-dtbook-migrator/master/web/docs/api_v1.yaml</kbd></pre>
	  <h1><a name="installation-1" class="anchor" href="#installation-1"><span class="octicon octicon-link"></span></a>Last Pipeline 2 based version: 1.5.2</h1>
	  <p>Note that earlier 1.x versions supported normal Pipeline 2 installation and the Pipeline 2 updater mechanism. However, 1.5.2 does only run as a Docker container.</p>
          <p>If you want to install the tool using some other mechanism than Docker, the JAR file is available from the <a href="https://github.com/nlbdev/nordic-epub3-dtbook-migrator/tree/mvn-repo/org/daisy/pipeline/modules/nordic-epub3-dtbook-migrator">Maven repository on GitHub</a>, or from the <a href="https://github.com/nlbdev/nordic-epub3-dtbook-migrator/releases">GitHub Release page</a>. The GitHub Release page also contains a description of changes for each release.</p>
                    
          <h2>Using Docker</h2>
          <p>The Nordic Migrator is published as <code>nlbdev/nordic-epub3-dtbook-migrator</code>, tagged with release versions.</p>
          <p>Example of how to run the Nordic EPUB3/DTBook Migrator with Docker:</p>
          <pre><kbd>docker run --detach --name pipeline -e PIPELINE2_WS_HOST=0.0.0.0 -e PIPELINE2_WS_AUTHENTICATION=false nlbdev/nordic-epub3-dtbook-migrator:1.5.2</kbd></pre>
          
          <p>After starting the Nordic Migrator, you could also start the Pipeline 2 Web UI on the same system like this, if you don't have any other interface (starts on <a href="http://localhost:9000/">http://localhost:9000/</a>):</p>
          <pre><kbd>docker run --detach --link pipeline -p 9000:9000 --name pipeline-webui -v webui-data:/opt/daisy-pipeline2-webui/data -e DAISY_PIPELINE2_URL=http://pipeline:8181/ws daisyorg/pipeline-webui:v2.7.1</kbd></pre>

	  <h3>Using docker-compose</h3>
	  <p>A slightly more elaborate method of running the validator in Docker is using <a href="https://docs.docker.com/compose/"><kbd>docker-compose</kbd></a>.</p>
	  <p>Suggested <code>docker-compose.yml</code> file:</p>
	  <pre>
<code>services:
   pipeline:
      image: nlbdev/nordic-epub3-dtbook-migrator:1.5.2
      environment:
         PIPELINE2_WS_HOST: "0.0.0.0"
         PIPELINE2_WS_AUTHENTICATION: "false"
      volumes:
         - "pipeline-data:/opt/daisy-pipeline2/data"
   webui:
     image: daisyorg/pipeline-webui:v2.7.1
     environment:
        DAISY_PIPELINE2_URL: http://pipeline:8181/ws
     ports:
        - "9000:9000"
     volumes:
        - "webui-data:/opt/daisy-pipeline2-webui/data"
     depends_on:
        pipeline:
           condition: service_healthy
volumes:
   pipeline-data:
   webui-data:</code>
	  </pre>
	  <p>The two containers can now be started jointly with the following suggested command (replace the path with your docker-compose.yml location):</p>
	  <pre><kbd>docker-compose -f [path to docker-compose.yml] up --force-recreate -d</kbd></pre>
	  <p>The web UI service should now be up and running on <a href="http://localhost:9000/">http://localhost:9000/</a>, which you can access from a browser to manage Nordic Migrator jobs (e.g. validation).</p>
	  <p><strong>Please note that adding e.g. <code>restart: always</code> to the .yml config file will restart the containers after Docker or system restart. However, on Windows, the web UI container will not be successfully resumed after system restart this way. So either exit Docker Desktop before system shutdown, or initiate the containers afresh with the command above. There are many ways of setting up Docker services, please refer to the <a href="https://docs.docker.com/">Docker documentation</a> to learn more.</strong></p>

	    <h1><a name="resources" class="anchor" href="#resources"><span class="octicon octicon-link"></span></a>Resources</h1>
	    <h2>General</h2>
	    <ul>
	      <li><a href="https://github.com/nlbdev/nordic-epub3-dtbook-migrator/issues/">Issue tracker (GitHub; report issues here)</a></li>
	      <li><a href="https://format.mtm.se/nordic_epub/2020-1/">Nordic Guidelines for the Production of Accessible EPUB 3 (Version: 2020-1)</a></li>
	      <li><a href="https://format.mtm.se/nordic_epub/2015-1/">Requirements for Quality Content Production in EPUB 3.0/XHTML (Version: 2015-1)</a></li>
	      <li><a href="resources/dtbook_markup_requirements_2011-2_v_1.docx">Requirements for Text and Image Quality and Markup with DTBook XML (Version: 2011-2)</a></li>
	    </ul>
	    <h2>Mapping and validation</h2>
	    <p><strong>NB, conversion between EPUB 3 and DTBook is currently only supported for 2015-1 guidelines.</strong></p>
	    <ul>
	      <li><a href="schemadoc/2020-1/index.html">List of 2020-1 validation rules</a></li>
	      <li><a href="schemadoc/2015-1/index.html">List of 2015-1 validation rules</a></li>
	      <li><a href="mapping.html">Documentation for the mapping between HTML and DTBook</a> (2015-1, not normative)</li>
	      <li><a href="classes.html">Documentation for the classes used in the Nordic EPUB3 profile</a> (2015-1, not normative)</li>
	    </ul>
	    <h2>Tool user guides</h2>
	    <ul>
	      <li><a href="guide/index.html">Nordic EPUB3/DTBook Migrator User Guide (web interface)</a> <strong>Please note: The book categories mentioned at the end are outdated and not applicable to present/coming contracts with the Nordic Agencies</strong></li>
	      <li><a href="https://daisy.github.io/pipeline/Get-Help/User-Guide/">DAISY Pipeline 2 User Guide</a></li>
	    </ul>
        </article>
      </div>
    </div>
    <footer>
      <div class="owner">
      <p><a href="https://github.com/nlbdev" class="avatar"><img src="https://avatars3.githubusercontent.com/u/6852279?s=60" width="48" height="48"/></a> <a href="https://github.com/nlbdev">nlbdev</a> maintains <a href="https://github.com/nlbdev/nordic-epub3-dtbook-migrator">Nordic EPUB3/DTBook Migrator</a></p>


      </div>
      <div class="creds">
        <small>This page generated using <a href="https://pages.github.com/">GitHub Pages</a><br/>theme by <a href="https://twitter.com/jonrohan/">Jon Rohan</a></small>
      </div>
    </footer>
  </div>
  <div class="current-section">
    <a href="#top">Scroll to top</a>
    <a href="https://github.com/nlbdev/nordic-epub3-dtbook-migrator/tarball/master" class="tar">tar</a><a href="https://github.com/nlbdev/nordic-epub3-dtbook-migrator/zipball/master" class="zip">zip</a><a href="" class="code">source code</a>
    <p class="name"></p>
  </div>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-51973045-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

</body>
</html>
